# 证件管理器 (Identity Manager)

一个基于大模型的智能证件识别和管理应用，支持识别30种常见证件类型，包括身份证、护照、驾驶证、营业执照、毕业证等。

## 功能特性

- 📸 **智能识别**: 基于大模型API的证件图片识别
- 🔒 **安全存储**: 本地加密存储证件信息
- 📱 **多证件支持**: 支持30种常见证件类型，包括身份证、护照、驾驶证、营业执照、毕业证等
- 🎯 **高精度识别**: 支持多种证件字段的精确提取
- ⚙️ **灵活配置**: 可配置大模型API参数
- 🔄 **自动备份**: 支持数据自动备份和恢复

## 技术架构

- **前端框架**: HarmonyOS ArkTS
- **大模型API**: OpenAI GPT-4 Vision / 其他支持视觉的模型
- **数据存储**: 本地SQLite数据库
- **图片处理**: HarmonyOS CameraKit & ImageKit

## 代理服务配置

### 服务信息

应用使用预配置的代理服务进行证件识别，无需用户配置API密钥。

- **服务地址**: `http://47.111.83.157/llm`
- **认证方式**: 签名验证
- **支持功能**: 多模态图片识别

### 服务状态检查

1. **打开应用设置**
   - 进入应用 → 设置
   - 查看"代理服务状态"部分

2. **检查连接状态**
   - 绿色圆点表示服务正常
   - 红色圆点表示服务异常
   - 点击"重新测试连接"按钮刷新状态

### API请求格式

应用会向代理服务发送以下格式的请求：

```json
{
  "prompt": "请分析这张证件图片，识别证件类型并提取关键信息...",
  "image_base64": "{base64编码的图片}",
  "max_tokens": 2000,
  "temperature": 0.1
}
```

### 认证头格式

```json
{
  "X-Timestamp": "1703123456",
  "X-AppId": "freelancer.zhujx",
  "X-Nonce": "a1b2c3d4",
  "X-Signature": "sha256签名"
}
```

### 响应格式

代理服务应返回以下格式的JSON响应：

```json
{
  "isDocument": true,
  "documentType": "身份证",
  "confidence": 0.95,
  "message": "",
  "fields": [
    {
      "key": "name",
      "value": "张三",
      "label": "姓名",
      "confidence": 0.95
    },
    {
      "key": "id_number",
      "value": "110101199001011234",
      "label": "公民身份号码",
      "confidence": 0.98
    }
  ]
}
```

### 支持的证件类型

应用支持以下30种证件类型：

**身份类证件**：身份证、居住证、护照、户口本、军人证、团员证、党员证、港澳通行证

**职业资格类**：从业资格证、英语四六级证、汽车驾驶证

**车辆相关**：行驶证、养路费证、营运证

**企业证照**：营业执照、经营许可证、税务登记证、卫生许可证、消防许可证

**婚姻家庭**：结婚证、涉外婚姻证明、离婚证、出生证、预防接种证、节育证

**社会保障**：养老保险证

**教育类**：毕业证、学位证

**其他**：签证、国有土地使用证

如果上传的图片不是证件或不在支持列表中，系统会提示用户并归类为"其他"。

## 使用说明

### 添加证件

1. **选择上传方式**
   - 拍照上传: 使用相机拍摄证件
   - 从相册选择: 选择已有的证件照片

2. **图片预览**
   - 确认图片清晰度
   - 调整图片角度（如需要）

3. **智能识别**
   - 系统自动调用大模型API识别证件
   - 提取关键信息字段
   - 显示识别结果和置信度

4. **编辑和保存**
   - 检查识别结果
   - 编辑不准确的字段
   - 保存到本地数据库

### 管理证件

- **查看列表**: 浏览所有已保存的证件
- **搜索功能**: 按证件类型或关键词搜索
- **编辑信息**: 修改证件详细信息
- **删除证件**: 安全删除不需要的证件

## 隐私安全

- 🔐 **本地存储**: 所有数据存储在设备本地
- 🔒 **加密保护**: 敏感信息使用加密存储
- 🚫 **不上传**: 证件图片不会上传到云端
- 🛡️ **权限控制**: 最小化权限申请

## 开发环境

### 系统要求

- HarmonyOS 4.0+
- DevEco Studio 4.0+
- Node.js 16+

### 安装依赖

```bash
npm install
```

### 运行项目

1. 在DevEco Studio中打开项目
2. 配置API密钥（见配置步骤）
3. 连接设备或启动模拟器
4. 点击运行按钮

## 项目结构

```
IdentityManager/
├── entry/                    # 主模块
│   └── src/main/ets/
│       ├── pages/           # 页面组件
│       ├── services/        # 服务层
│       ├── manager/         # 数据管理
│       ├── model/           # 数据模型
│       ├── utils/           # 工具类
│       └── types/           # 类型定义
├── AppScope/                # 应用级配置
└── README.md               # 项目说明
```

## 核心文件说明

- `DocumentRecognitionService.ets`: 大模型API调用服务
- `UploadPage.ets`: 证件上传和识别页面
- `SettingsPage.ets`: 应用设置和API配置
- `CommonUtils.ets`: 通用工具和配置管理
- `ImageUtils.ets`: 图片处理工具

## 故障排除

### 常见问题

1. **代理服务连接失败**
   - 检查网络连接
   - 确认代理服务是否正常运行
   - 查看设置页面中的服务状态

2. **识别准确率低**
   - 确保图片清晰度足够
   - 避免强光反射
   - 保持证件完整可见

3. **应用崩溃**
   - 检查设备存储空间
   - 重启应用
   - 清除应用缓存

### 日志查看

在DevEco Studio的控制台中查看详细日志：

```bash
# 查看代理服务调用日志
console.log('开始使用代理服务识别文档...')

# 查看错误信息
console.error('文档识别失败:', error)
```

## 贡献指南

欢迎提交Issue和Pull Request来改进项目。

## 许可证

本项目采用 MIT 许可证。

## 联系方式

如有问题或建议，请通过以下方式联系：

- 邮箱: [your-email@example.com]
- GitHub: [项目地址]

---

**注意**: 请确保遵守相关法律法规，合理使用大模型API，保护个人隐私信息。 